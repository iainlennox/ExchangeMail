  Determining projects to restore...
  All projects are up-to-date for restore.
  ExchangeMail.Core -> C:\Users\iain\source\repos\AI\ExchangeMail\ExchangeMail.Core\bin\Debug\net10.0\ExchangeMail.Core.dll
  ExchangeMail.Web -> C:\Users\iain\source\repos\AI\ExchangeMail\ExchangeMail.Web\bin\Debug\net10.0\ExchangeMail.Web.dll
  ExchangeMail.Tests -> C:\Users\iain\source\repos\AI\ExchangeMail\ExchangeMail.Tests\bin\Debug\net10.0\ExchangeMail.Tests.dll
Test run for C:\Users\iain\source\repos\AI\ExchangeMail\ExchangeMail.Tests\bin\Debug\net10.0\ExchangeMail.Tests.dll (.NETCoreApp,Version=v10.0)
VSTest version 18.0.1 (x64)

Starting test execution, please wait...
A total of 1 test files matched the specified pattern.
  Failed ExchangeMail.Tests.Controllers.MailControllerTests.EmptyTrash_RedirectsToIndex_WhenSuccessful [4 ms]
  Error Message:
   Moq.MockException : 
Expected invocation on the mock once, but was 0 times: r => r.EmptyTrashAsync("testuser")

Performed invocations:

   Mock<IMailRepository:7> (r):

      IMailRepository.EmptyTrashAsync("testuser@")

  Stack Trace:
     at Moq.Mock.Verify(Mock mock, LambdaExpression expression, Times times, String failMessage) in /_/src/Moq/Mock.cs:line 332
   at Moq.Mock`1.Verify[TResult](Expression`1 expression, Func`1 times) in /_/src/Moq/Mock`1.cs:line 840
   at ExchangeMail.Tests.Controllers.MailControllerTests.EmptyTrash_RedirectsToIndex_WhenSuccessful() in C:\Users\iain\source\repos\AI\ExchangeMail\ExchangeMail.Tests\Controllers\MailControllerTests.cs:line 343
--- End of stack trace from previous location ---
  Failed ExchangeMail.Tests.Controllers.MailControllerTests.ReplyAll_ReturnsViewResult_WithPopulatedData [4 ms]
  Error Message:
   Assert.IsType() Failure: Value is not the exact type
Expected: typeof(Microsoft.AspNetCore.Mvc.ViewResult)
Actual:   typeof(Microsoft.AspNetCore.Mvc.RedirectToActionResult)
  Stack Trace:
     at ExchangeMail.Tests.Controllers.MailControllerTests.ReplyAll_ReturnsViewResult_WithPopulatedData() in C:\Users\iain\source\repos\AI\ExchangeMail\ExchangeMail.Tests\Controllers\MailControllerTests.cs:line 257
--- End of stack trace from previous location ---
  Failed ExchangeMail.Tests.Controllers.MailControllerTests.Reply_ReturnsViewResult_WithPopulatedData [2 ms]
  Error Message:
   Assert.IsType() Failure: Value is not the exact type
Expected: typeof(Microsoft.AspNetCore.Mvc.ViewResult)
Actual:   typeof(Microsoft.AspNetCore.Mvc.RedirectToActionResult)
  Stack Trace:
     at ExchangeMail.Tests.Controllers.MailControllerTests.Reply_ReturnsViewResult_WithPopulatedData() in C:\Users\iain\source\repos\AI\ExchangeMail\ExchangeMail.Tests\Controllers\MailControllerTests.cs:line 234
--- End of stack trace from previous location ---
  Failed ExchangeMail.Tests.Controllers.MailControllerTests.CopyMessage_RedirectsToIndex_WhenSuccessful [1 ms]
  Error Message:
   Assert.IsType() Failure: Value is not the exact type
Expected: typeof(Microsoft.AspNetCore.Mvc.RedirectToActionResult)
Actual:   typeof(Microsoft.AspNetCore.Mvc.OkResult)
  Stack Trace:
     at ExchangeMail.Tests.Controllers.MailControllerTests.CopyMessage_RedirectsToIndex_WhenSuccessful() in C:\Users\iain\source\repos\AI\ExchangeMail\ExchangeMail.Tests\Controllers\MailControllerTests.cs:line 313
--- End of stack trace from previous location ---
  Failed ExchangeMail.Tests.Controllers.MailControllerTests.MoveMessage_RedirectsToIndex_WhenSuccessful [1 ms]
  Error Message:
   Assert.IsType() Failure: Value is not the exact type
Expected: typeof(Microsoft.AspNetCore.Mvc.RedirectToActionResult)
Actual:   typeof(Microsoft.AspNetCore.Mvc.OkResult)
  Stack Trace:
     at ExchangeMail.Tests.Controllers.MailControllerTests.MoveMessage_RedirectsToIndex_WhenSuccessful() in C:\Users\iain\source\repos\AI\ExchangeMail\ExchangeMail.Tests\Controllers\MailControllerTests.cs:line 296
--- End of stack trace from previous location ---
  Failed ExchangeMail.Tests.Controllers.MailControllerTests.Forward_ReturnsViewResult_WithPopulatedData [3 ms]
  Error Message:
   Assert.IsType() Failure: Value is not the exact type
Expected: typeof(Microsoft.AspNetCore.Mvc.ViewResult)
Actual:   typeof(Microsoft.AspNetCore.Mvc.RedirectToActionResult)
  Stack Trace:
     at ExchangeMail.Tests.Controllers.MailControllerTests.Forward_ReturnsViewResult_WithPopulatedData() in C:\Users\iain\source\repos\AI\ExchangeMail\ExchangeMail.Tests\Controllers\MailControllerTests.cs:line 278
--- End of stack trace from previous location ---

Failed!  - Failed:     6, Passed:    38, Skipped:     0, Total:    44, Duration: 401 ms - ExchangeMail.Tests.dll (net10.0)
